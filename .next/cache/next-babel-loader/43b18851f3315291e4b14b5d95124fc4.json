{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar _this = this,\n    _jsxFileName = \"/home/noa/ntdbProject/app/NTDB/components/profile/profilePic.js\";\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect, useContext } from 'react';\nimport { ProfileContext } from '../../store/contexts/profileContext'; //import Navbar from '../../layouts/navbar'\n\nimport '../../public/assets/style.scss';\nimport Logout from '../../utility/logout';\nimport ReactCrop from 'react-image-crop';\nimport 'react-image-crop/dist/ReactCrop.css';\nimport { base64StringtoFile, extractImageFileExtensionFromBase64, image64toCanvasRef } from './fileUtility';\nimport axiosFuncs from '../../utility/axios';\nimport Validator from 'validatorjs'; //   const cropper = React.createRef(null);\n\nvar ProfilePic = function ProfilePic(props) {\n  var _useContext = useContext(ProfileContext),\n      dispatch = _useContext.dispatch;\n\n  var imagePreviewCanvasRef = React.createRef();\n\n  var _useState = useState({\n    profileStep: 7,\n    profilePicUrl: '',\n    profilePicFile: '',\n    crop: {\n      // unit: 'px',\n      aspect: 1 / 1 //    width: 50,\n\n    }\n  }),\n      profilePic = _useState[0],\n      setProfilePic = _useState[1];\n\n  var _useState2 = useState(true),\n      buttonStateF = _useState2[0],\n      setButtonStateF = _useState2[1];\n\n  var _useState3 = useState(false),\n      buttonStateB = _useState3[0],\n      setButtonStateB = _useState3[1];\n\n  var rules = {\n    profilePicUrl: 'required',\n    profilePicFile: 'required' //  email: 'required|email',\n    //  age: 'min:18'\n\n  };\n  var validation = new Validator(profilePic, rules, {\n    required: 'required*'\n  });\n  validation.fails(); // true\n\n  validation.passes(); // false\n\n  useEffect(function () {\n    if (validation.passes()) {\n      setButtonStateF(false); // console.log(\"the   buttonStete \"+buttonState);  \n    } else {\n      setButtonStateF(true);\n    }\n  }, [profilePic]);\n\n  var handleImageChange = function handleImageChange(e) {\n    e.preventDefault();\n    var reader = new FileReader();\n    var profilePicFile = e.target.files[0]; //   console.log(\"this is the imagfe check view ===================>>>>>>>>>>>>>\" +profilePicFile);\n\n    reader.onloadend = function () {\n      setProfilePic(_objectSpread({}, profilePic, {\n        profilePicFile: profilePicFile,\n        profilePicUrl: reader.result\n      }));\n    };\n\n    reader.readAsDataURL(profilePicFile);\n  }; // from here\n\n\n  var handleCrop = function handleCrop(crop, percentCrop) {\n    console.log(\"this is the crop \" + JSON.stringify(crop));\n    console.log(\"this is the percent crop \" + JSON.stringify(percentCrop)); //onComplete(crop, percentCrop)\n\n    setProfilePic(_objectSpread({}, profilePic, {\n      crop: percentCrop\n    }));\n  };\n\n  var handleImageLoaded = function handleImageLoaded(image) {\n    console.log(\"the image that is loaded\" + image);\n  };\n\n  var handleCompleteCrop = function handleCompleteCrop(crop, pixelCrop) {\n    console.log(\"the crop and the pixel \" + JSON.stringify(crop) + JSON.stringify(pixelCrop));\n    var canvasRef = imagePreviewCanvasRef.current;\n    var imgSrc = profilePic.profilePicUrl;\n    image64toCanvasRef(canvasRef, imgSrc, crop);\n  }; // save the successfully cropped image to state \n\n\n  var handleImageSaveWithCrop = function handleImageSaveWithCrop(e) {\n    e.preventDefault();\n    var canvasRef = imagePreviewCanvasRef.current;\n    var imgSrc = profilePic.profilePicUrl;\n    var fileExtension = extractImageFileExtensionFromBase64(imgSrc);\n    var imageDate64 = canvasRef.toDataURL('image/' + fileExtension);\n    console.log(\"the profilePicFile extension is this ===>> \" + fileExtension);\n    var newFileName = \"nomalevo.\" + fileExtension;\n    console.log(\"the new profilePicFile name \" + newFileName); // profilePicFile to be uploaded\n\n    var newCroppedFile = base64StringtoFile(imageDate64, newFileName); //   console.log(\"this si the final cropped \"+JSON.stringify(newCroppedFile));\n    //  console.log(\"this is the imagfe check view cropped profilePicFile ===================>>>>>>>>>>>>>\" +newCroppedFile);\n\n    setProfilePic(_objectSpread({}, profilePic, {\n      profilePicFile: newCroppedFile\n    }));\n    var stateObj = {\n      profileStep: 8,\n      profilePicUrl: profilePic.profilePicUrl,\n      profilePicFile: newCroppedFile\n    }; //     this.props.fileStateUpdate(profilePic);\n    //props.fileStateUpdate(stateObj);\n    //download the profilePicFile\n    // downloadBase64File(imageDate64, newFileName)\n  }; // save the image  to state without cropping it\n\n\n  var handleImageSaveWithoutCrop = function handleImageSaveWithoutCrop(e) {\n    e.preventDefault(); // setProfilePic({ ...profilePic, profilePicFile: newCroppedFile })  \n    // this.setState({\n    //   profileStep: 8\n    //  // profilePicFile: newCroppedFile   \n    //   })\n    //   const stateObj = {\n    //     profileStep:8,\n    //     profilePicUrl: profilePic.profilePicUrl,\n    //     profilePicFile: profilePic.profilePicFile,\n    //   }\n    //   //   this.props.fileStateUpdate(profilePicj);\n    // this.props.fileStateUpdate(stateObj);\n  };\n\n  var checkToSkipCrop = function checkToSkipCrop() {\n    if (profilePic.profilePicUrl) {\n      return \"inline\";\n    } else {\n      return \"none\";\n    }\n  };\n\n  var checkToUpladCropped = function checkToUpladCropped() {\n    if (profilePic.crop.height) {\n      return \"inline\";\n    } else {\n      return \"none\";\n    }\n  };\n\n  var styles = {\n    // height: '50vh',\n    //   minHeight: '93vh'\n    width: \"200\",\n    height: \"500\"\n  };\n  var conStyle = {\n    // height: '50vh',\n    //   minHeight: '93vh'\n    //   display:\"inline\"\n    cropped: {\n      display: checkToUpladCropped()\n    },\n    notCropped: {\n      display: checkToSkipCrop()\n    }\n  }; // to here\n  // const  handleChange =(e) => {\n  //         e.preventDefault(); \n  //         setProfilePic({ ...profilePic, [e.target.id]: e.target.value })\n  //       }\n\n  var handleForward = function handleForward(e) {\n    var next, go;\n    return _regeneratorRuntime.async(function handleForward$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            e.preventDefault(); //   dispatch({type: 'ADD_PROFILE_DATA', payload: profilePic});\n\n            dispatch({\n              type: 'ADD_PROFILE_DATA',\n              payload: {\n                profilePic: profilePic\n              }\n            });\n            next = \"F\";\n            _context.next = 5;\n            return _regeneratorRuntime.awrap(props.updatestep(next));\n\n          case 5:\n            go = _context.sent;\n            dispatch({\n              type: 'CURRENT_STEP',\n              payload: profilePic.profileStep + 1\n            });\n\n            if (!go) {\n              _context.next = 9;\n              break;\n            }\n\n            return _context.abrupt(\"return\", go);\n\n          case 9:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var handleBack = function handleBack(e) {\n    var next, go;\n    return _regeneratorRuntime.async(function handleBack$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            e.preventDefault();\n            next = \"B\";\n            _context2.next = 4;\n            return _regeneratorRuntime.awrap(props.updatestep(next));\n\n          case 4:\n            go = _context2.sent;\n            dispatch({\n              type: 'CURRENT_STEP',\n              payload: profilePic.profileStep - 1\n            });\n\n            if (!go) {\n              _context2.next = 8;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", go);\n\n          case 8:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var handleSaveNow = function handleSaveNow(e) {\n    return _regeneratorRuntime.async(function handleSaveNow$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            //  console.log(\"i am here to save first foitiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiii\");\n            e.preventDefault(); // const data =  {...profilePic,  profileStep: profilePic.profileStep+1};\n\n            dispatch({\n              type: 'CLEAR_CONTEXT'\n            });\n            Logout(); //logout();\n\n          case 3:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return __jsx(\"div\", {\n    className: \"pagegrid\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    className: \"innergrid\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 318,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"profile-form\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 320,\n      columnNumber: 13\n    }\n  }, __jsx(\"h3\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 13\n    }\n  }, \"Profile Pic\"), __jsx(\"div\", {\n    className: \"one-column-row\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"column\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 19\n    }\n  }, __jsx(\"div\", {\n    style: conStyle.notCropped,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 21\n    }\n  }, \"Drag you mouse over the image to crop or click the button below to skip\"), __jsx(\"input\", {\n    type: \"file\",\n    id: \"profilePic\",\n    onChange: function onChange(e) {\n      return handleImageChange(e);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 21\n    }\n  }))), __jsx(\"div\", {\n    className: \"two-column-row\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 335,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"column\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 19\n    }\n  }, __jsx(ReactCrop, {\n    src: profilePic.profilePicUrl,\n    onImageLoaded: handleImageLoaded,\n    onComplete: handleCompleteCrop,\n    circularCrop: \"true\",\n    crop: profilePic.crop,\n    onChange: handleCrop,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 338,\n      columnNumber: 23\n    }\n  }), __jsx(\"button\", {\n    style: conStyle.notCropped,\n    onClick: handleImageSaveWithoutCrop,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 23\n    }\n  }, \" Skip Cropping And Upload Image \")), __jsx(\"div\", {\n    className: \"column\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 350,\n      columnNumber: 19\n    }\n  }, __jsx(\"canvas\", {\n    ref: imagePreviewCanvasRef,\n    style: styles,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 351,\n      columnNumber: 21\n    }\n  }), __jsx(\"button\", {\n    style: conStyle.cropped,\n    onClick: handleImageSaveWithCrop,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 21\n    }\n  }, \" Upload  Cropped Image \"))), __jsx(\"div\", {\n    className: \"two-column-row\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 361,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: \"column\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 362,\n      columnNumber: 23\n    }\n  }, __jsx(\"button\", {\n    disabled: buttonStateB,\n    size: \"small\",\n    color: \"primary\",\n    onClick: handleBack,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 363,\n      columnNumber: 26\n    }\n  }, \"Back\")), __jsx(\"div\", {\n    className: \"column\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 366,\n      columnNumber: 23\n    }\n  }, __jsx(\"button\", {\n    disabled: buttonStateF,\n    size: \"small\",\n    color: \"primary\",\n    onClick: handleForward,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 367,\n      columnNumber: 26\n    }\n  }, \"Next\"))), __jsx(\"div\", {\n    className: \"one-column-row\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 371,\n      columnNumber: 23\n    }\n  }, __jsx(\"div\", {\n    className: \"column componentFooter\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 23\n    }\n  }, __jsx(\"span\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 373,\n      columnNumber: 26\n    }\n  }, \"6/6\"))))));\n};\n\nexport default ProfilePic;","map":{"version":3,"sources":["/home/noa/ntdbProject/app/NTDB/components/profile/profilePic.js"],"names":["React","useState","useEffect","useContext","ProfileContext","Logout","ReactCrop","base64StringtoFile","extractImageFileExtensionFromBase64","image64toCanvasRef","axiosFuncs","Validator","ProfilePic","props","dispatch","imagePreviewCanvasRef","createRef","profileStep","profilePicUrl","profilePicFile","crop","aspect","profilePic","setProfilePic","buttonStateF","setButtonStateF","buttonStateB","setButtonStateB","rules","validation","required","fails","passes","handleImageChange","e","preventDefault","reader","FileReader","target","files","onloadend","result","readAsDataURL","handleCrop","percentCrop","console","log","JSON","stringify","handleImageLoaded","image","handleCompleteCrop","pixelCrop","canvasRef","current","imgSrc","handleImageSaveWithCrop","fileExtension","imageDate64","toDataURL","newFileName","newCroppedFile","stateObj","handleImageSaveWithoutCrop","checkToSkipCrop","checkToUpladCropped","height","styles","width","conStyle","cropped","display","notCropped","handleForward","type","payload","next","updatestep","go","handleBack","handleSaveNow"],"mappings":";;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAAyBC,SAAzB,EAAoCC,UAApC,QAAsD,OAAtD;AAEA,SAASC,cAAT,QAA+B,qCAA/B,C,CAEA;;AAEA,OAAO,gCAAP;AAEA,OAAOC,MAAP,MAAmB,sBAAnB;AAGA,OAAOC,SAAP,MAAsB,kBAAtB;AAEA,OAAO,qCAAP;AAGA,SAAUC,kBAAV,EAA+BC,mCAA/B,EAAoEC,kBAApE,QAA6F,eAA7F;AACA,OAAOC,UAAP,MAAuB,qBAAvB;AAGA,OAAOC,SAAP,MAAsB,aAAtB,C,CAIC;;AAED,IAAMC,UAAU,GAAG,SAAbA,UAAa,CAACC,KAAD,EAAW;AAAA,oBAIFV,UAAU,CAACC,cAAD,CAJR;AAAA,MAIhBU,QAJgB,eAIhBA,QAJgB;;AAMxB,MAAMC,qBAAqB,GAAGf,KAAK,CAACgB,SAAN,EAA9B;;AANwB,kBAQYf,QAAQ,CACpC;AAEEgB,IAAAA,WAAW,EAAE,CAFf;AAGEC,IAAAA,aAAa,EAAE,EAHjB;AAIEC,IAAAA,cAAc,EAAE,EAJlB;AAKEC,IAAAA,IAAI,EAAE;AACN;AACEC,MAAAA,MAAM,EAAE,IAAI,CAFR,CAGR;;AAHQ;AALR,GADoC,CARpB;AAAA,MAQjBC,UARiB;AAAA,MAQLC,aARK;;AAAA,mBAuBYtB,QAAQ,CAAC,IAAD,CAvBpB;AAAA,MAuBrBuB,YAvBqB;AAAA,MAuBPC,eAvBO;;AAAA,mBAwBYxB,QAAQ,CAAC,KAAD,CAxBpB;AAAA,MAwBrByB,YAxBqB;AAAA,MAwBPC,eAxBO;;AA0B5B,MAAIC,KAAK,GAAG;AAEVV,IAAAA,aAAa,EAAE,UAFL;AAGVC,IAAAA,cAAc,EAAE,UAHN,CAMZ;AACA;;AAPY,GAAZ;AAUA,MAAIU,UAAU,GAAG,IAAIlB,SAAJ,CAAcW,UAAd,EAA0BM,KAA1B,EAAiC;AAAEE,IAAAA,QAAQ,EAAE;AAAZ,GAAjC,CAAjB;AAEAD,EAAAA,UAAU,CAACE,KAAX,GAtC4B,CAsCR;;AACpBF,EAAAA,UAAU,CAACG,MAAX,GAvC4B,CAuCP;;AAKrB9B,EAAAA,SAAS,CAAC,YAAM;AAEd,QAAI2B,UAAU,CAACG,MAAX,EAAJ,EAAyB;AACjBP,MAAAA,eAAe,CAAC,KAAD,CAAf,CADiB,CAEnB;AACH,KAHH,MAGO;AACHA,MAAAA,eAAe,CAAC,IAAD,CAAf;AAEL;AACF,GATU,EAST,CAACH,UAAD,CATS,CAAT;;AAYA,MAAMW,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,CAAD,EAAO;AACvBA,IAAAA,CAAC,CAACC,cAAF;AAEA,QAAIC,MAAM,GAAG,IAAIC,UAAJ,EAAb;AACA,QAAIlB,cAAc,GAAGe,CAAC,CAACI,MAAF,CAASC,KAAT,CAAe,CAAf,CAArB,CAJuB,CAM3B;;AAEIH,IAAAA,MAAM,CAACI,SAAP,GAAmB,YAAM;AACrBjB,MAAAA,aAAa,mBAAMD,UAAN;AAAkBH,QAAAA,cAAc,EAAEA,cAAlC;AAAkDD,QAAAA,aAAa,EAAEkB,MAAM,CAACK;AAAxE,SAAb;AACH,KAFD;;AAIAL,IAAAA,MAAM,CAACM,aAAP,CAAqBvB,cAArB;AACD,GAbT,CAxD4B,CAsE9B;;;AAIA,MAAMwB,UAAU,GAAG,SAAbA,UAAa,CAACvB,IAAD,EAAOwB,WAAP,EAAuB;AAExCC,IAAAA,OAAO,CAACC,GAAR,CAAY,sBAAoBC,IAAI,CAACC,SAAL,CAAe5B,IAAf,CAAhC;AAEAyB,IAAAA,OAAO,CAACC,GAAR,CAAY,8BAA4BC,IAAI,CAACC,SAAL,CAAeJ,WAAf,CAAxC,EAJwC,CAOxC;;AACArB,IAAAA,aAAa,mBAAMD,UAAN;AAAmBF,MAAAA,IAAI,EAAEwB;AAAzB,OAAb;AAED,GAVD;;AAYA,MAAMK,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,KAAD,EAAW;AAEzBL,IAAAA,OAAO,CAACC,GAAR,CAAY,6BAA2BI,KAAvC;AAED,GAJX;;AAMA,MAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,CAAC/B,IAAD,EAAOgC,SAAP,EAAqB;AAE/CP,IAAAA,OAAO,CAACC,GAAR,CAAY,4BAA0BC,IAAI,CAACC,SAAL,CAAe5B,IAAf,CAA1B,GAAiD2B,IAAI,CAACC,SAAL,CAAeI,SAAf,CAA7D;AAEC,QAAMC,SAAS,GAAGtC,qBAAqB,CAACuC,OAAxC;AAEA,QAAMC,MAAM,GAAGjC,UAAU,CAACJ,aAA1B;AAEAT,IAAAA,kBAAkB,CAAC4C,SAAD,EAAYE,MAAZ,EAAoBnC,IAApB,CAAlB;AAED,GAVD,CA5F8B,CAyG9B;;;AACA,MAAMoC,uBAAuB,GAAG,SAA1BA,uBAA0B,CAACtB,CAAD,EAAO;AAErCA,IAAAA,CAAC,CAACC,cAAF;AAEA,QAAMkB,SAAS,GAAGtC,qBAAqB,CAACuC,OAAxC;AACA,QAAMC,MAAM,GAAGjC,UAAU,CAACJ,aAA1B;AACA,QAAMuC,aAAa,GAAGjD,mCAAmC,CAAC+C,MAAD,CAAzD;AACA,QAAMG,WAAW,GAAGL,SAAS,CAACM,SAAV,CAAoB,WAAUF,aAA9B,CAApB;AAEAZ,IAAAA,OAAO,CAACC,GAAR,CAAY,gDAA8CW,aAA1D;AAEA,QAAMG,WAAW,GAAG,cAAcH,aAAlC;AAEAZ,IAAAA,OAAO,CAACC,GAAR,CAAY,iCAA+Bc,WAA3C,EAbqC,CAerC;;AACA,QAAMC,cAAc,GAAGtD,kBAAkB,CAACmD,WAAD,EAAcE,WAAd,CAAzC,CAhBqC,CAkBvC;AAEA;;AACKrC,IAAAA,aAAa,mBAAMD,UAAN;AAAkBH,MAAAA,cAAc,EAAE0C;AAAlC,OAAb;AAIH,QAAMC,QAAQ,GAAG;AACb7C,MAAAA,WAAW,EAAC,CADC;AAEbC,MAAAA,aAAa,EAAEI,UAAU,CAACJ,aAFb;AAGbC,MAAAA,cAAc,EAAE0C;AAHH,KAAjB,CAzBqC,CAgCvC;AAGE;AAGC;AACH;AAOC,GA9CD,CA1G8B,CA4J9B;;;AACA,MAAME,0BAA0B,GAAG,SAA7BA,0BAA6B,CAAC7B,CAAD,EAAO;AACxCA,IAAAA,CAAC,CAACC,cAAF,GADwC,CAGxC;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AAGA;AAID,GAvBD;;AA4BA,MAAM6B,eAAe,GAAG,SAAlBA,eAAkB,GAAM;AAE5B,QAAG1C,UAAU,CAACJ,aAAd,EAA4B;AAC1B,aAAO,QAAP;AACD,KAFD,MAEO;AACL,aAAO,MAAP;AACD;AAGF,GATD;;AAYA,MAAM+C,mBAAmB,GAAG,SAAtBA,mBAAsB,GAAM;AAEhC,QAAG3C,UAAU,CAACF,IAAX,CAAgB8C,MAAnB,EAA0B;AACxB,aAAO,QAAP;AACD,KAFD,MAEO;AACL,aAAO,MAAP;AACD;AAEF,GARD;;AAUA,MAAMC,MAAM,GAAG;AACb;AACA;AACEC,IAAAA,KAAK,EAAC,KAHK;AAIZF,IAAAA,MAAM,EAAC;AAJK,GAAf;AAOA,MAAMG,QAAQ,GAAG;AACb;AACA;AACD;AACAC,IAAAA,OAAO,EAAG;AAAEC,MAAAA,OAAO,EAAEN,mBAAmB;AAA9B,KAJI;AAKdO,IAAAA,UAAU,EAAG;AAAED,MAAAA,OAAO,EAAEP,eAAe;AAA1B;AALC,GAAjB,CAtN8B,CAgO9B;AAEA;AACA;AACA;AAEA;;AAGA,MAAMS,aAAa,GAAG,SAAhBA,aAAgB,CAAMvC,CAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAEdA,YAAAA,CAAC,CAACC,cAAF,GAFc,CAGd;;AACArB,YAAAA,QAAQ,CAAC;AAAC4D,cAAAA,IAAI,EAAE,kBAAP;AAA2BC,cAAAA,OAAO,EAAE;AAACrD,gBAAAA,UAAU,EAAEA;AAAb;AAApC,aAAD,CAAR;AAEMsD,YAAAA,IANQ,GAMD,GANC;AAAA;AAAA,6CAOG/D,KAAK,CAACgE,UAAN,CAAiBD,IAAjB,CAPH;;AAAA;AAORE,YAAAA,EAPQ;AAQdhE,YAAAA,QAAQ,CAAC;AAAC4D,cAAAA,IAAI,EAAE,cAAP;AAAuBC,cAAAA,OAAO,EAAErD,UAAU,CAACL,WAAX,GAAuB;AAAvD,aAAD,CAAR;;AARc,iBASX6D,EATW;AAAA;AAAA;AAAA;;AAAA,6CAUPA,EAVO;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAtB;;AAeA,MAAMC,UAAU,GAAG,SAAbA,UAAa,CAAM7C,CAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAEXA,YAAAA,CAAC,CAACC,cAAF;AAEMyC,YAAAA,IAJK,GAIE,GAJF;AAAA;AAAA,6CAKM/D,KAAK,CAACgE,UAAN,CAAiBD,IAAjB,CALN;;AAAA;AAKLE,YAAAA,EALK;AAMXhE,YAAAA,QAAQ,CAAC;AAAC4D,cAAAA,IAAI,EAAE,cAAP;AAAuBC,cAAAA,OAAO,EAAErD,UAAU,CAACL,WAAX,GAAuB;AAAvD,aAAD,CAAR;;AANW,iBAOR6D,EAPQ;AAAA;AAAA;AAAA;;AAAA,8CASJA,EATI;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAnB;;AAeA,MAAME,aAAa,GAAG,SAAhBA,aAAgB,CAAM9C,CAAN;AAAA;AAAA;AAAA;AAAA;AAGhB;AAEAA,YAAAA,CAAC,CAACC,cAAF,GALgB,CAOhB;;AAIArB,YAAAA,QAAQ,CAAC;AAAC4D,cAAAA,IAAI,EAAE;AAAP,aAAD,CAAR;AACArE,YAAAA,MAAM,GAZU,CAchB;;AAdgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAtB;;AAqBE,SAIE;AAAK,IAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAGI;AAAK,IAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEI;AAAK,IAAA,SAAS,EAAC,cAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAFA,EAKA;AAAK,IAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACM;AAAK,IAAA,SAAS,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEE;AAAK,IAAA,KAAK,EAAEgE,QAAQ,CAACG,UAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+EAFF,EAGE;AAAQ,IAAA,IAAI,EAAC,MAAb;AAAoB,IAAA,EAAE,EAAC,YAAvB;AAAoC,IAAA,QAAQ,EAAE,kBAACtC,CAAD;AAAA,aAAKD,iBAAiB,CAACC,CAAD,CAAtB;AAAA,KAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHF,CADN,CALA,EAeA;AAAK,IAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACM;AAAK,IAAA,SAAS,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEI,MAAC,SAAD;AACA,IAAA,GAAG,EAAEZ,UAAU,CAACJ,aADhB;AAEA,IAAA,aAAa,EAAE+B,iBAFf;AAGA,IAAA,UAAU,EAAEE,kBAHZ;AAIA,IAAA,YAAY,EAAC,MAJb;AAKA,IAAA,IAAI,EAAE7B,UAAU,CAACF,IALjB;AAMA,IAAA,QAAQ,EAAEuB,UANV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFJ,EAUI;AAAQ,IAAA,KAAK,EAAE0B,QAAQ,CAACG,UAAxB;AAAoC,IAAA,OAAO,EAAET,0BAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wCAVJ,CADN,EAeM;AAAK,IAAA,SAAS,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAQ,IAAA,GAAG,EAAEhD,qBAAb;AAAoC,IAAA,KAAK,EAAEoD,MAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,EAEE;AAAS,IAAA,KAAK,EAAEE,QAAQ,CAACC,OAAzB;AAAkC,IAAA,OAAO,EAAEd,uBAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAFF,CAfN,CAfA,EAyCA;AAAK,IAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACU;AAAK,IAAA,SAAS,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG;AAAQ,IAAA,QAAQ,EAAE9B,YAAlB;AAAiC,IAAA,IAAI,EAAC,OAAtC;AAA8C,IAAA,KAAK,EAAC,SAApD;AAA8D,IAAA,OAAO,EAAEqD,UAAvE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADH,CADV,EAKU;AAAK,IAAA,SAAS,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG;AAAQ,IAAA,QAAQ,EAAEvD,YAAlB;AAAgC,IAAA,IAAI,EAAC,OAArC;AAA6C,IAAA,KAAK,EAAC,SAAnD;AAA6D,IAAA,OAAO,EAAEiD,aAAtE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YADH,CALV,CAzCA,EAmDU;AAAK,IAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACA;AAAK,IAAA,SAAS,EAAC,wBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WADH,CADA,CAnDV,CAFJ,CAHJ,CAJF;AA0ED,CAtWD;;AAyWA,eAAe7D,UAAf","sourcesContent":["import React, { useState,useEffect, useContext } from 'react'\n\nimport { ProfileContext } from '../../store/contexts/profileContext'\n\n//import Navbar from '../../layouts/navbar'\n\nimport '../../public/assets/style.scss';\n\nimport Logout from '../../utility/logout'\n\n\nimport ReactCrop from 'react-image-crop'\n\nimport 'react-image-crop/dist/ReactCrop.css';\n\n\nimport  { base64StringtoFile,  extractImageFileExtensionFromBase64, image64toCanvasRef} from './fileUtility'\nimport axiosFuncs from '../../utility/axios';\n\n\nimport Validator from 'validatorjs';\n\n\n\n //   const cropper = React.createRef(null);\n\nconst ProfilePic = (props) => {\n\n\n\n      const { dispatch  } = useContext(ProfileContext);\n\n      const imagePreviewCanvasRef = React.createRef();\n\n      const [profilePic, setProfilePic] = useState(\n              {\n    \n                profileStep: 7,\n                profilePicUrl: '',\n                profilePicFile: '',\n                crop: {\n                // unit: 'px',\n                  aspect: 1 / 1 ,\n              //    width: 50,\n                } \n\n\n              })\n\n  const [buttonStateF, setButtonStateF] = useState(true);\n  const [buttonStateB, setButtonStateB] = useState(false);\n                  \n  let rules = {\n\n    profilePicUrl: 'required',\n    profilePicFile: 'required',\n   \n\n  //  email: 'required|email',\n  //  age: 'min:18'\n  };\n  \n  let validation = new Validator(profilePic, rules, { required: 'required*' });\n\n  validation.fails(); // true\n  validation.passes(); // false\n\n\n\n\n  useEffect(() => {\n\n    if (validation.passes()) {\n            setButtonStateF(false);\n          // console.log(\"the   buttonStete \"+buttonState);  \n      }else{\n        setButtonStateF(true);\n      \n  }\n},[profilePic]);\n\n\n  const handleImageChange = (e) => {\n            e.preventDefault();\n\n            let reader = new FileReader();\n            let profilePicFile = e.target.files[0];\n\n        //   console.log(\"this is the imagfe check view ===================>>>>>>>>>>>>>\" +profilePicFile);\n\n            reader.onloadend = () => {\n                setProfilePic({ ...profilePic, profilePicFile: profilePicFile, profilePicUrl: reader.result })  \n            }\n\n            reader.readAsDataURL(profilePicFile)\n          }\n// from here\n\n\n\nconst handleCrop = (crop, percentCrop) => {\n\n  console.log(\"this is the crop \"+JSON.stringify(crop));\n\n  console.log(\"this is the percent crop \"+JSON.stringify(percentCrop));\n\n\n  //onComplete(crop, percentCrop)\n  setProfilePic({ ...profilePic,  crop: percentCrop })  \n\n}\n\nconst handleImageLoaded = (image) => {\n\n            console.log(\"the image that is loaded\"+image);\n          \n          }\n          \nconst handleCompleteCrop = (crop, pixelCrop) => {\n\n console.log(\"the crop and the pixel \"+JSON.stringify(crop) + JSON.stringify(pixelCrop));\n\n  const canvasRef = imagePreviewCanvasRef.current\n\n  const imgSrc = profilePic.profilePicUrl\n\n  image64toCanvasRef(canvasRef, imgSrc, crop)\n\n}\n\n\n// save the successfully cropped image to state \nconst handleImageSaveWithCrop = (e) => {\n\n  e.preventDefault();\n\n  const canvasRef = imagePreviewCanvasRef.current\n  const imgSrc = profilePic.profilePicUrl\n  const fileExtension = extractImageFileExtensionFromBase64(imgSrc)\n  const imageDate64 = canvasRef.toDataURL('image/'+ fileExtension)\n\n  console.log(\"the profilePicFile extension is this ===>> \"+fileExtension);\n\n  const newFileName = \"nomalevo.\" + fileExtension\n\n  console.log(\"the new profilePicFile name \"+newFileName);\n\n  // profilePicFile to be uploaded\n  const newCroppedFile = base64StringtoFile(imageDate64, newFileName)\n\n//   console.log(\"this si the final cropped \"+JSON.stringify(newCroppedFile));\n\n//  console.log(\"this is the imagfe check view cropped profilePicFile ===================>>>>>>>>>>>>>\" +newCroppedFile);\n     setProfilePic({ ...profilePic, profilePicFile: newCroppedFile })  \n\n\n\n  const stateObj = {\n      profileStep:8,\n      profilePicUrl: profilePic.profilePicUrl,\n      profilePicFile: newCroppedFile\n\n    }\n\n//     this.props.fileStateUpdate(profilePic);\n\n\n  //props.fileStateUpdate(stateObj);\n\n\n   //download the profilePicFile\n// downloadBase64File(imageDate64, newFileName)\n\n\n\n\n\n\n}\n\n\n\n// save the image  to state without cropping it\nconst handleImageSaveWithoutCrop = (e) => {\n  e.preventDefault();\n\n  // setProfilePic({ ...profilePic, profilePicFile: newCroppedFile })  \n\n  // this.setState({\n  //   profileStep: 8\n  //  // profilePicFile: newCroppedFile   \n  //   })\n\n  //   const stateObj = {\n  //     profileStep:8,\n  //     profilePicUrl: profilePic.profilePicUrl,\n  //     profilePicFile: profilePic.profilePicFile,\n\n  //   }\n  //   //   this.props.fileStateUpdate(profilePicj);\n\n\n  // this.props.fileStateUpdate(stateObj);\n\n\n\n}\n\n\n\n\nconst checkToSkipCrop = () => {\n\n  if(profilePic.profilePicUrl){\n    return \"inline\"\n  } else {\n    return \"none\"\n  }\n  \n\n}\n\n\nconst checkToUpladCropped = () => {\n\n  if(profilePic.crop.height){\n    return \"inline\"\n  } else {\n    return \"none\"\n  }\n\n}\n\nconst styles = {\n  // height: '50vh',\n  //   minHeight: '93vh'\n    width:\"200\" ,\n   height:\"500\"\n  }\n\nconst conStyle = {\n    // height: '50vh',\n    //   minHeight: '93vh'\n   //   display:\"inline\"\n   cropped : { display: checkToUpladCropped() },\n   notCropped : { display: checkToSkipCrop() }\n      \n    }\n\n\n// to here\n\n// const  handleChange =(e) => {\n//         e.preventDefault(); \n//         setProfilePic({ ...profilePic, [e.target.id]: e.target.value })\n\n//       }\n\n\nconst handleForward = async e => {\n\n        e.preventDefault();\n        //   dispatch({type: 'ADD_PROFILE_DATA', payload: profilePic});\n        dispatch({type: 'ADD_PROFILE_DATA', payload: {profilePic: profilePic}});\n\n        const next = \"F\"\n        const go = await props.updatestep(next);\n        dispatch({type: 'CURRENT_STEP', payload: profilePic.profileStep+1});\n        if(go){\n        return go\n        }\n\n        }\n\nconst handleBack = async e => {\n\n        e.preventDefault();\n\n        const next = \"B\"\n        const go = await props.updatestep(next);\n        dispatch({type: 'CURRENT_STEP', payload: profilePic.profileStep-1});\n        if(go){\n\n        return go\n        }\n\n        }\n\n\nconst handleSaveNow = async e => {\n\n\n      //  console.log(\"i am here to save first foitiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiii\");\n\n      e.preventDefault();\n\n      // const data =  {...profilePic,  profileStep: profilePic.profileStep+1};\n      \n\n\n      dispatch({type: 'CLEAR_CONTEXT'});\n      Logout();\n\n      //logout();\n\n      }\n\n \n\n\n  return (\n\n\n\n    <div className=\"pagegrid\">\n      {/* <Navbar /> */}\n\n        <div className=\"innergrid\">\n\n            <div className=\"profile-form\" >\n\n            <h3>Profile Pic</h3>\n\n\n            <div className=\"one-column-row\">\n                  <div className=\"column\">\n                                      \n                    <div style={conStyle.notCropped} >Drag you mouse over the image to crop or click the button below to skip</div>\n                    <input  type='file' id=\"profilePic\" onChange={(e)=>handleImageChange(e)} />\n                 \n                      \n                  </div>\n            </div>\n\n            <div className=\"two-column-row\">\n                  <div className=\"column\">\n                                      \n                      <ReactCrop \n                      src={profilePic.profilePicUrl}\n                      onImageLoaded={handleImageLoaded}\n                      onComplete={handleCompleteCrop} \n                      circularCrop=\"true\"\n                      crop={profilePic.crop} \n                      onChange={handleCrop} />\n\n                      <button style={conStyle.notCropped} onClick={handleImageSaveWithoutCrop}> Skip Cropping And Upload Image </button>\n\n              \n                  </div>\n                  <div className=\"column\">\n                    <canvas ref={imagePreviewCanvasRef} style={styles} ></canvas> \n                    <button  style={conStyle.cropped} onClick={handleImageSaveWithCrop}> Upload  Cropped Image </button>\n        \n                  </div>\n            </div>\n\n\n\n\n\n            <div className=\"two-column-row\">\n                      <div className=\"column\">\n                         <button disabled={buttonStateB}  size=\"small\" color=\"primary\" onClick={handleBack}>Back</button>\n                      </div>\n                  \n                      <div className=\"column\">\n                         <button disabled={buttonStateF} size=\"small\" color=\"primary\" onClick={handleForward}>Next</button>\n                      </div>\n                \n                </div>\n                      <div className=\"one-column-row\">\n                      <div className=\"column componentFooter\">\n                         <span>6/6</span>\n                      </div>\n                  </div>\n                 \n\n            </div>\n        </div>\n    </div>\n\n\n\n  )\n}\n\n\nexport default ProfilePic;\n\n\n"]},"metadata":{},"sourceType":"module"}