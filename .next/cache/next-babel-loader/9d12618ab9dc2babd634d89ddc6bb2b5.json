{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar _this = this,\n    _jsxFileName = \"/home/noa/ntdbProject/app/NTDB/components/auth/login.js\";\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState } from 'react';\nimport Link from 'next/link';\nimport axios from 'axios';\nimport { useRouter } from 'next/router';\nimport Cookie from 'js-cookie';\nimport jwtFuncs from '../../utility/jwt';\nimport localStorageFuncs from '../../utility/localStorage';\nimport config from '../../config/config';\n\nvar Login = function Login(props) {\n  var router = useRouter();\n\n  var _useState = useState({\n    email: '',\n    password: ''\n  }),\n      user = _useState[0],\n      setUser = _useState[1];\n\n  var handleChange = function handleChange(e) {\n    e.preventDefault();\n    setUser(_objectSpread({}, user, _defineProperty({}, e.target.id, e.target.value)));\n  };\n\n  var handleSubmit = function handleSubmit(e) {\n    var localJWT, options, url, apiCall, token;\n    return _regeneratorRuntime.async(function handleSubmit$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            e.preventDefault();\n            console.log(\"the current state before submit state \" + JSON.stringify(user));\n\n            localJWT = function localJWT() {\n              var localCookie = Cookie.get('auth');\n              return localCookie ? localCookie : undefined; //    const localJWT = localStorage.getItem(\"jwt\");\n              //   return localJWT ? JSON.parse(localJWT) : '';\n            }; // connect to the db via axios and the dispatch an action based on the server response\n\n\n            options = {\n              withCredentials: true,\n              headers: {\n                'Authorization': \"Bearer \".concat(localJWT)\n              }\n            };\n            url = config.apiUrl + 'login';\n            _context.next = 7;\n            return _regeneratorRuntime.awrap(axios.post(url, user));\n\n          case 7:\n            apiCall = _context.sent;\n            console.log(\"API response \" + apiCall.data.userToken);\n            token = apiCall.data.userToken;\n\n            if (token) {\n              Cookie.set(\"auth\", token);\n              localStorageFuncs.setItemInStorage(\"auth\", token); // decode the token and return the users details\n              //     let isProfileComplete = jwtFuncs.jwtProfile(token);\n              //  let isProfileComplete = '\"1\"'\n\n              console.log(\"this is the returned vaalue \" + isProfileComplete);\n              router.push('/profile');\n            }\n\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var handleLink = function handleLink() {\n    var next, go;\n    return _regeneratorRuntime.async(function handleLink$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            next = 2;\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(props.updatestep(next));\n\n          case 3:\n            go = _context2.sent;\n\n            if (!go) {\n              _context2.next = 6;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", go);\n\n          case 6:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return __jsx(\"div\", {\n    className: \"pagegrid\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 1\n    }\n  }, __jsx(\"div\", {\n    className: \"innergrid\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 9\n    }\n  }, __jsx(\"form\", {\n    className: \"form\",\n    onSubmit: handleSubmit,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 13\n    }\n  }, __jsx(\"h3\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 21\n    }\n  }, \" Login \"), __jsx(\"div\", {\n    className: \"grid\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 19\n    }\n  }, __jsx(\"label\", {\n    htmlFor: \"email\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 21\n    }\n  }, \"Email\"), __jsx(\"input\", {\n    onChange: handleChange,\n    name: \"email\",\n    id: \"email\",\n    type: \"email\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 21\n    }\n  })), __jsx(\"div\", {\n    className: \"grid\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 19\n    }\n  }, __jsx(\"label\", {\n    htmlFor: \"password\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 21\n    }\n  }, \"Password\"), __jsx(\"input\", {\n    onChange: handleChange,\n    name: \"password\",\n    id: \"password\",\n    type: \"password\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 21\n    }\n  })), __jsx(\"div\", {\n    className: \"grid\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 19\n    }\n  }, __jsx(\"button\", {\n    className: \"button\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 21\n    }\n  }, \"submit\")), __jsx(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 21\n    }\n  }, \"Don't have an account?   \", __jsx(\"a\", {\n    onClick: handleLink,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 49\n    }\n  }, \"Register\")))));\n};\n\nexport default Login; //export default  withStyles(Login);","map":{"version":3,"sources":["/home/noa/ntdbProject/app/NTDB/components/auth/login.js"],"names":["React","useState","Link","axios","useRouter","Cookie","jwtFuncs","localStorageFuncs","config","Login","props","router","email","password","user","setUser","handleChange","e","preventDefault","target","id","value","handleSubmit","console","log","JSON","stringify","localJWT","localCookie","get","undefined","options","withCredentials","headers","url","apiUrl","post","apiCall","data","userToken","token","set","setItemInStorage","isProfileComplete","push","handleLink","next","updatestep","go"],"mappings":";;;;;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAAgC,OAAhC;AAEA,OAAOC,IAAP,MAAiB,WAAjB;AAEA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,SAASC,SAAT,QAA0B,aAA1B;AAEA,OAAOC,MAAP,MAAmB,WAAnB;AAEA,OAAOC,QAAP,MAAqB,mBAArB;AACA,OAAOC,iBAAP,MAA8B,4BAA9B;AACA,OAAOC,MAAP,MAAmB,qBAAnB;;AAMA,IAAMC,KAAK,GAAG,SAARA,KAAQ,CAACC,KAAD,EAAW;AAEnB,MAAMC,MAAM,GAAGP,SAAS,EAAxB;;AAFmB,kBAKKH,QAAQ,CAC5B;AACEW,IAAAA,KAAK,EAAE,EADT;AAEEC,IAAAA,QAAQ,EAAE;AAFZ,GAD4B,CALb;AAAA,MAKZC,IALY;AAAA,MAKNC,OALM;;AAarB,MAAOC,YAAY,GAAE,SAAdA,YAAc,CAACC,CAAD,EAAO;AAE1BA,IAAAA,CAAC,CAACC,cAAF;AACIH,IAAAA,OAAO,mBAAMD,IAAN,sBAAaG,CAAC,CAACE,MAAF,CAASC,EAAtB,EAA2BH,CAAC,CAACE,MAAF,CAASE,KAApC,GAAP;AAEH,GALH;;AAOA,MAAOC,YAAY,GAAG,SAAfA,YAAe,CAAOL,CAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAElBA,YAAAA,CAAC,CAACC,cAAF;AAEAK,YAAAA,OAAO,CAACC,GAAR,CAAY,2CAAyCC,IAAI,CAACC,SAAL,CAAeZ,IAAf,CAArD;;AAEMa,YAAAA,QANY,GAMD,SAAXA,QAAW,GAAM;AAErB,kBAAMC,WAAW,GAAGvB,MAAM,CAACwB,GAAP,CAAW,MAAX,CAApB;AAEA,qBAAOD,WAAW,GAAGA,WAAH,GAAiBE,SAAnC,CAJqB,CAMzB;AACC;AAEA,aAfmB,EAiBrB;;;AAEOC,YAAAA,OAnBc,GAmBJ;AACdC,cAAAA,eAAe,EAAE,IADH;AAEdC,cAAAA,OAAO,EAAE;AACP,kDAA2BN,QAA3B;AADO;AAFK,aAnBI;AA0BbO,YAAAA,GA1Ba,GA0BP1B,MAAM,CAAC2B,MAAP,GAAc,OA1BP;AAAA;AAAA,6CA4BChC,KAAK,CAACiC,IAAN,CAAWF,GAAX,EAAgBpB,IAAhB,CA5BD;;AAAA;AA4BfuB,YAAAA,OA5Be;AA+BnBd,YAAAA,OAAO,CAACC,GAAR,CAAY,kBAAgBa,OAAO,CAACC,IAAR,CAAaC,SAAzC;AAEMC,YAAAA,KAjCa,GAiCLH,OAAO,CAACC,IAAR,CAAaC,SAjCR;;AAmCnB,gBAAGC,KAAH,EAAS;AAEJnC,cAAAA,MAAM,CAACoC,GAAP,CAAW,MAAX,EAAmBD,KAAnB;AAEAjC,cAAAA,iBAAiB,CAACmC,gBAAlB,CAAmC,MAAnC,EAA2CF,KAA3C,EAJI,CAOJ;AAEN;AACE;;AAEIjB,cAAAA,OAAO,CAACC,GAAR,CAAY,iCAAgCmB,iBAA5C;AAGIhC,cAAAA,MAAM,CAACiC,IAAP,CAAY,UAAZ;AAGP;;AArDiB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAtB;;AA0DA,MAAMC,UAAU,GAAG,SAAbA,UAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AACXC,YAAAA,IADW,GACJ,CADI;AAAA;AAAA,6CAEApC,KAAK,CAACqC,UAAN,CAAiBD,IAAjB,CAFA;;AAAA;AAEXE,YAAAA,EAFW;;AAAA,iBAGdA,EAHc;AAAA;AAAA;AAAA;;AAAA,8CAIRA,EAJQ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAnB;;AAUE,SAEN;AAAK,IAAA,SAAS,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEQ;AAAK,IAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEI;AAAM,IAAA,SAAS,EAAC,MAAhB;AAAwB,IAAA,QAAQ,EAAE1B,YAAlC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAGQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAHR,EAKM;AAAK,IAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAO,IAAA,OAAO,EAAC,OAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADF,EAEE;AAAO,IAAA,QAAQ,EAAEN,YAAjB;AAAgC,IAAA,IAAI,EAAC,OAArC;AAA6C,IAAA,EAAE,EAAC,OAAhD;AAAwD,IAAA,IAAI,EAAC,OAA7D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CALN,EASM;AAAK,IAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAO,IAAA,OAAO,EAAC,UAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,EAEE;AAAO,IAAA,QAAQ,EAAEA,YAAjB;AAAgC,IAAA,IAAI,EAAC,UAArC;AAAgD,IAAA,EAAE,EAAC,UAAnD;AAA8D,IAAA,IAAI,EAAC,UAAnE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CATN,EAaM;AAAK,IAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAQ,IAAA,SAAS,EAAC,QAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,CAbN,EAiBQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kCAA4B;AAAG,IAAA,OAAO,EAAE6B,UAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAA5B,CAjBR,CAFJ,CAFR,CAFM;AAkCL,CA1HD;;AA+HA,eAAepC,KAAf,C,CAGA","sourcesContent":["import React, { useState } from 'react'\n\nimport Link from 'next/link'\n\nimport axios from 'axios';\n\nimport { useRouter } from 'next/router'\n\nimport Cookie from 'js-cookie'\n\nimport jwtFuncs from '../../utility/jwt'\nimport localStorageFuncs from '../../utility/localStorage';\nimport config from '../../config/config';\n\n\n\n\n\nconst Login = (props) => {\n\n      const router = useRouter()\n\n\n      const [user, setUser] = useState(\n          {\n            email: '',\n            password: ''\n          \n          }\n      );\n\n    const  handleChange =(e) => {\n\n      e.preventDefault();\n          setUser({ ...user, [e.target.id]: e.target.value })\n    \n      }\n      \n    const  handleSubmit = async (e) => {\n\n        e.preventDefault();\n\n        console.log(\"the current state before submit state \"+JSON.stringify(user));\n\n        const localJWT = () => {\n\n          const localCookie = Cookie.get('auth'); \n\n          return localCookie ? localCookie : undefined;\n\n      //    const localJWT = localStorage.getItem(\"jwt\");\n       //   return localJWT ? JSON.parse(localJWT) : '';\n\n      }\n\n     // connect to the db via axios and the dispatch an action based on the server response\n\n      const options = {\n        withCredentials: true,\n        headers: {\n          'Authorization': `Bearer ${localJWT}`\n        }\n      } \n\n       const url = config.apiUrl+'login'\n\n       let apiCall = await axios.post(url, user);\n\n\n       console.log(\"API response \"+apiCall.data.userToken);\n\n       const token = apiCall.data.userToken;\n\n       if(token){\n\n            Cookie.set(\"auth\", token);\n\n            localStorageFuncs.setItemInStorage(\"auth\", token);\n\n          \n            // decode the token and return the users details\n\n      //     let isProfileComplete = jwtFuncs.jwtProfile(token);\n        //  let isProfileComplete = '\"1\"'\n\n            console.log(\"this is the returned vaalue \"+ isProfileComplete);\n   \n\n                router.push('/profile')\n  \n\n        }\n\n\n      }\n\n    const handleLink = async()=>{\n      const next = 2;\n      const go = await props.updatestep(next);\n      if(go){\n        return go\n      }\n    }\n\n\n        \n      return (\n\n<div className=\"pagegrid\">\n\n        <div className=\"innergrid\">\n\n            <form className=\"form\"  onSubmit={handleSubmit} >\n                    \n                  \n                    <h3> Login </h3>\n          \n                  <div className=\"grid\">\n                    <label htmlFor=\"email\">Email</label>\n                    <input onChange={handleChange}  name=\"email\" id=\"email\" type=\"email\" />\n                  </div>\n                  <div className=\"grid\">\n                    <label htmlFor=\"password\">Password</label>\n                    <input onChange={handleChange}  name=\"password\" id=\"password\" type=\"password\" />\n                  </div>\n                  <div className=\"grid\">\n                    <button className=\"button\">submit</button>\n                  </div>\n              \n                    <p>Don't have an account?   <a onClick={handleLink}>Register</a></p>\n                   \n                                \n            </form>\n\n          \n        </div>\n    \n\n        </div>\n      )\n}\n\n\n\n\nexport default Login;\n\n\n//export default  withStyles(Login);\n"]},"metadata":{},"sourceType":"module"}